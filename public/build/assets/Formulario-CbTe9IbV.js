import{e,o as l,a as r,p as b,f as h,s as u,z as d,L as f,F as c,h as m,t as n}from"./app-mLNlLAFm.js";import{_ as g}from"./_plugin-vue_export-helper-DlAUqK2U.js";const y={name:"GestionUsuario",data(){return{usuarios:[],roles:[],usuario:{correo:"",password:"",rol_id:""},editando:!1}},mounted(){this.cargarUsuarios(),this.cargarRoles()},methods:{async cargarUsuarios(){try{const i=await axios.get("/api/usuarios");this.usuarios=i.data}catch(i){console.error("Error al cargar usuarios:",i)}},async cargarRoles(){try{const i=await axios.get("/api/roles");this.roles=i.data}catch(i){console.error("Error al cargar roles:",i)}},async guardarUsuario(){try{this.editando?await axios.put(`/api/usuarios/${this.usuario.id}`,this.usuario):await axios.post("/api/usuarios",this.usuario),this.limpiarFormulario(),this.cargarUsuarios()}catch(i){console.error("Error al guardar usuario:",i)}},editarUsuario(i){this.usuario={...i},this.editando=!0},async eliminarUsuario(i){if(confirm("¿Está seguro de eliminar este usuario?"))try{await axios.delete(`/api/usuarios/${i}`),this.cargarUsuarios()}catch(o){console.error("Error al eliminar usuario:",o)}},limpiarFormulario(){this.usuario={correo:"",password:"",rol_id:""},this.editando=!1},cancelarEdicion(){this.limpiarFormulario()}}},_={class:"container"},v={class:"row"},U={class:"col-md-12"},w={class:"card"},C={class:"card-body"},E={class:"form-group mb-3"},k={class:"form-group mb-3"},x=["required"],F={class:"form-group mb-3"},S=["value"],V={type:"submit",class:"btn btn-primary"},q={class:"card-body"},R={class:"table"},B=["onClick"],M=["onClick"];function z(i,o,A,D,a,t){return l(),e("div",_,[r("div",v,[r("div",U,[r("div",w,[o[10]||(o[10]=r("div",{class:"card-header"},[r("h3",{class:"card-title"},"Gestión de Usuarios")],-1)),r("div",C,[r("form",{onSubmit:o[4]||(o[4]=b((...s)=>t.guardarUsuario&&t.guardarUsuario(...s),["prevent"]))},[r("div",E,[o[5]||(o[5]=r("label",null,"Correo",-1)),u(r("input",{"onUpdate:modelValue":o[0]||(o[0]=s=>a.usuario.correo=s),type:"email",class:"form-control",required:""},null,512),[[d,a.usuario.correo]])]),r("div",k,[o[6]||(o[6]=r("label",null,"Contraseña",-1)),u(r("input",{"onUpdate:modelValue":o[1]||(o[1]=s=>a.usuario.password=s),type:"password",class:"form-control",required:!a.editando},null,8,x),[[d,a.usuario.password]])]),r("div",F,[o[8]||(o[8]=r("label",null,"Rol",-1)),u(r("select",{"onUpdate:modelValue":o[2]||(o[2]=s=>a.usuario.rol_id=s),class:"form-control",required:""},[o[7]||(o[7]=r("option",{value:""},"Seleccione un rol",-1)),(l(!0),e(c,null,m(a.roles,s=>(l(),e("option",{key:s.id,value:s.id},n(s.nombre),9,S))),128))],512),[[f,a.usuario.rol_id]])]),r("button",V,n(a.editando?"Actualizar":"Crear"),1),a.editando?(l(),e("button",{key:0,onClick:o[3]||(o[3]=(...s)=>t.cancelarEdicion&&t.cancelarEdicion(...s)),type:"button",class:"btn btn-secondary ml-2"}," Cancelar ")):h("",!0)],32)]),r("div",q,[r("table",R,[o[9]||(o[9]=r("thead",null,[r("tr",null,[r("th",null,"Correo"),r("th",null,"Rol"),r("th",null,"Acciones")])],-1)),r("tbody",null,[(l(!0),e(c,null,m(a.usuarios,s=>(l(),e("tr",{key:s.id},[r("td",null,n(s.correo),1),r("td",null,n(s.rol?s.rol.nombre:"Sin rol"),1),r("td",null,[r("button",{onClick:p=>t.editarUsuario(s),class:"btn btn-sm btn-info me-2"}," Editar ",8,B),r("button",{onClick:p=>t.eliminarUsuario(s.id),class:"btn btn-sm btn-danger"}," Eliminar ",8,M)])]))),128))])])])])])])])}const N=g(y,[["render",z]]);export{N as default};
